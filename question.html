{% extends "base.html" %}
{% block content %}

<h1>Question {{ question_number }}</h1>

<p>{{ question['question'] }}</p>

<form id="quiz-form" method="POST">
    {% for option in question['options'] %}
    <label>
        <input type="radio" name="answer" value="{{ option }}">
        {{ option }}
    </label><br>
    {% endfor %}
    <button type="submit" class="btn">Next</button>
</form>

<div class="chat-container">
    <h2>Chat with our Bot</h2>
    <div id="chat-history">
        {% for sender, message in chat_history %}
        <p><strong>{{ sender }}:</strong> {{ message }}</p>
        {% endfor %}
    </div>
    <input type="text" id="chat-input" placeholder="Type your message...">
    <button onclick="sendMessage()" class="btn">Send</button>
</div>

<script>
    function sendMessage() {
        const chatInput = document.getElementById('chat-input');
        const message = chatInput.value;
        chatInput.value = '';

        fetch('/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ message: message })
        })
        .then(response => response.json())
        .then(data => {
            const chatHistory = document.getElementById('chat-history');
            chatHistory.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
            chatHistory.innerHTML += `<p><strong>Bot:</strong> ${data.response}</p>`;
            chatHistory.scrollTop = chatHistory.scrollHeight;
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
</script>

{% endblock %}